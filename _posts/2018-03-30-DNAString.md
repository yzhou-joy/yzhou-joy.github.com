---
title: "bioconductor and markdown"
date: 2018-03-30 14:56:09
categories:
- R
- bioconductor
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### bioconductor

#### **??????**  
```{r cars,eval=FALSE}
source("http://bioconductor.org/biocLite.R")
biocLite(c("GenomicFeatures", "GenomicRanges"))
``` 
      
##### XString??????????????????????????????????????????????????????????????????XString????????????????????????(??????????????????)??????
 - BString?????????????????????????????????
 - DNAString???????????????DNA????????????????????????
 - RNAString???????????????RNA?????????
 - AAString????????????????????????????????????????????????
      
#### **??????Biostrings?????????:**
```{r results="hide",message=FALSE}   
library(Biostrings)
```
```{r}
a=BString("I am a string!")
a
length(a) 
a[1:4]          #???????????????Subsetting:
subseq(a,1,4)   #????????????a[1:4]
```  
     
#### **?????????????????????:**
```{r}
rev(a)
```  
     
#### **????????????????????????????????????(???)???:**
```{r results='markup'}
a=="I am"
a[1:4]=="I am"
toString(a)
class(a)
class(toString(a))
```

#### **DNAString/RNAString**
##### ?????????????????????????????????????????????????????????
```{r}
IUPAC_CODE_MAP   #?????????????????????????????????????????????????????????????????????
DNA_ALPHABET
DNA_BASES
RNA_ALPHABET
RNA_BASES
```  
  
a=DNAString(???I am a string???)??????????????????I??????????????????????????????    
b=RNAString(???ATTGCC???)?????????????????????RNA_BASES???????????????T    
     
```{r}
a=DNAString("ATTGCC")
a
b=RNAString("AUUGCC")
b
complement(a)   #?????????
reverse(a)      #?????????
reverseComplement(a)      #???????????????
translate(a)    #???????????????????????????????????????
```

#### **??????????????????**
```{r}
alphabetFrequency(a)
alphabetFrequency(a, baseOnly=TRUE)    #??????MN??????M.N...???????????????
letterFrequency(a,"C")
letterFrequency(a,"CGT")
```

#### **???????????????????????????**
##### ???????????????????????????   
 - ????????????????????????????????????matchPattern???countPattern???vmatchPattern???vcountPattern   
 - ?????????????????????????????????matchPDict???countPDict   
 - ???????????????/?????????????????????PWM??????matchPWM???countPWM???PWMscoreStartingAt   
 - ??????/???????????????pairwiseAlignment???stringDist   

#### **matchPattern**
##### ??????????????????????????????????????????????????????????????????/???????????????????????????
```{r}
a=DNAString("ACGTACGTACGC")
matchPattern("CGT", a)
matchPattern("CGT", a, max.mismatch=1)    #?????????????????????1
m=matchPattern("CGT", a, max.mismatch=1)
start(m)    #??????????????????mers????????????
end(m)      #??????????????????mers?????????
length(m)     #?????????????????????????????????mers
countPattern("CGT", a, max.mismatch=1)    #?????????????????????????????????mers
```
##### ??????????????????????????????????????????????????????n-mers??????????????????   
 - GC????????????C????????????+???G??????????????????????????????????????????letterFrequency????????????????????????   
 - CpG??????????????????CG????????????    

#### **matchPDict**
##### ??????????????????????????????????????????????????????????????????matchPDict????????????R???????????????????????????
```{r}
a=DNAString("ACGTACGTACGC")
dict0=PDict(c("CGT","ACG"))
mm=matchPDict(dict0, a)
mm[[1]]   #??????CGT?????????
mm[[2]]   #??????ACG?????????
```   
    
####  **PWM**
#####  PWM(??????????????????), ????????????DNA motif
 - motif???????????????????????????????????????   
```{r}
a=DNAString("ACGTACGTACTC")
motif=matrix(c(0.97,0.01,0.01,0.01,0.1,0.5,0.39,0.01,0.01,0.05,0.5,0.44),nrow=4)  #??????????????????
rownames(motif)=c("A","C","G","T")     #?????????????????????A??????1???2???3??????????????????...???????????????3???????????????????????????
motif
matchPWM(motif, a)
countPWM(motif, a)   #?????????motif??????
PWMscoreStartingAt(motif, a, 1:10)
```
#### **????????????????????????????????????String views and set**
 - ??????????????????????????????????????????????????????????????????????????????   
 - ???????????????????????????mother?????????????????????????????????????????????view?????????set??????   
 - XStringViews??????????????????view????????????????????????start/end????????????   
 - DNAStringSet/RNAStringSet????????????????????????DNA/RNAString?????????   
 - StringSet?????????StringViews??????????????????      

#### **XStringViews???????????????**
```{r}
a=DNAString("ACGTACGTACTC")
a2=Views(a, start=c(1,5,8), end=c(3,8,12))
a2
subject(a2)    #a2???????????????a
length(a2)    #a2?????????
start(a2)     #a2?????????????????????
end(a2)       #a2?????????????????????
alphabetFrequency(a2, baseOnly=TRUE)    #????????????a2????????????????????????????????????
a2==DNAString("ACGT")    #??????????????????????????????
toString(a2)              #????????????????????????????????????a2
```
#### **DNAStringSet???????????????**
```{r}
a=DNAString("ACGTACGTACTC")
a2=DNAStringSet(a, start=c(1,5,9), end=c(4,8,12))
a2
a2[[3]]
alphabetFrequency(a2, baseOnly=TRUE)
```

#### **??????????????????StringSet??????????????????????????????Views??????set??????**
```{r error=TRUE}
a1=DNAStringSet(a, start=c(1,5,9), end=c(4,8,12))
a1
unique(a1)      #???????????????????????????????????????
a2=Views(a, start=c(1,5,9), end=c(4,8,12))    
unique(a2)     #??????????????????Views?????????unique??????
a1=Views(a, start=c(1,9), end=c(4,12))
a1
a2=Views(a, start=c(1), end=c(4))
a2
setdiff(a1,a2)   #??????
union(a1, a2)    #??????
a1=DNAStringSet(a, start=c(1,9), end=c(4,12))
a1
a2=DNAStringSet(a, start=c(1), end=c(4))
a2
setdiff(a1,a2)    #??????
union(a1,a2)    #??????
```
#### **?????????????????????????????????** 
 - ??????vmatchPattern???vmatchPDict   
 - ??????PWM?????????????????????   
```{r error=TRUE}
a=DNAString("ACGTACGTACTC")
a2=DNAStringSet(a, start=c(1,5,9), end=c(4,8,12))
a2
vv=vmatchPattern("CG", a2)
vv      #??????a2???????????????????????????CG????????????????????????CG??????????????????????????????232??????a2?????????????????????CG??????2???3?????????
vv[[1]]    
# ?????????????????????Views?????????   
a2=Views(a, start=c(1,5,9), end=c(4,8,12))
a2
vv=vmatchPattern("CG", a2)
```